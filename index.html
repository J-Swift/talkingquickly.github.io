<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Talking Quickly - Rails, Devops & Startups</title>
    
        <meta name="description" content="Blog by Ben Dixon, Ruby on Rails Developer, about rails, kubernetes, docker, climbing and startups" />
    


    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google-site-verification" content="iwXSC2H2VSO9iPyrWjNj3Prlx4zJY-l0EJRGVkFuUHk" />


    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"/>
    <link rel="canonical" href="https://www.talkingquickly.co.uk/">

</head>
<body class="home-template">


    <header class="site-head" >
    <div class="vertical">
        <div class="site-head-content" class="inner">
            
            <h1 class="blog-title">talkingquickly</h1>
            <h2 class="blog-description">
               kubernetes, rails, stress free deployment and small steps taken quickly
            </h2>
            <h2 class="blog-description">
                 <a href='about.html'> About me</a> 
                |
                <a target="_blank" href="https://leanpub.com/deploying_rails_applications?utm_source=tlqblog&utm_campaign=homepage_banner">Deploying Rails Book</a>
            </h2>

            <h3 class="best-of-header">best of</h3>
            <ul class="best-of-list">
            <li><a href="/2015/04/what-id-tell-myself-about-startups/">What I'd tell myself about startups if I could go back 5 years</a></li>
            <li><a href="/kubernetes-sso-a-detailed-guide">Kubernetes SSO - A detailed Guide</a></li>
            <li><a href="/getting-things-done-while-staying-sane">Getting things done while staying sane</a></li>
            <li><a href="/2017/11/startup-reading-list/">Startup Reading List</a></li>
            </ul>
        </div>
    </div>
</header>

<main class="content" role="main">

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="23 Mar 2021">23 Mar 2021</time></span>
            <h2 class="post-title"><a href="/managing-puma-with-systemd-user-instance-and-monit">Managing puma with the systemd user instance and monit</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>Many guides to deploying Rails with Capistrano will use systemd to have it auto-started when the system boots. This is often done using the system instance of systemd which by default can only be controlled by root.</p>

<p>The typical workaround for this is either to grant our Capistrano deployment user passwordless sudo access or to grant them passwordless sudo access to just the commands required to restart the rails (and potentially sidekiq) systemd services.</p>

<p>This can be avoided by using the systemd user instance, which allows persistent services to be managed as a non-root user. This is compatible with the default systemd configuration in Ubuntu 20.04.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="16 Mar 2021">16 Mar 2021</time></span>
            <h2 class="post-title"><a href="/capistrano-puma-systemd-permission-denied-@rb_io_repopen">Capistrano & Puma with Systemd; Permission denied @ rb_io_reopen</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>When using the capistrano puma gem with systemd, we may get the error:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>Permission denied @ rb_io_reopen - /home/deploy/LOG_FILE_PATH/shared/log/puma_access.log (Errno::EACCES)
</code></pre></div>
<p>This may be caused by doubling up on the puma app servers logging.</p>

<p>Typically our systemd unit will contain something like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>StandardOutput=append:/home/deploy/LOG_FILE_PATH/shared/log/puma_access.log
</code></pre></div>
<p>Which means that any data written to standard output will be appended to the log file specified by systemd.</p>

<p>If we&#39;re getting the above error, it&#39;s also likely that our <code>puma.rb</code> configuration file contains something like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>stdout_redirect &#39;/home/deploy/LOG_FILE_PATH/shared/log/puma_access.log&#39;, true
</code></pre></div>
<p>Which tells puma itself to write to a log file instead of to stdout.</p>

<p>This doubling up leads to the following:</p>

<ul>
<li>systemd creates the log file as the root user</li>
<li>puma which we will generally have running as a different user then tries to write to this same file, but it doesn&#39;t have permission because it was created by root</li>
</ul>

<p>The solution to this is simple, we can complete remove this line from <code>puma.rb</code>:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>stdout_redirect &#39;/home/deploy/LOG_FILE_PATH/shared/log/puma_access.log&#39;, true
</code></pre></div>
<p>Since the redirection of stdout is already being handled by systemd.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="14 Mar 2021">14 Mar 2021</time></span>
            <h2 class="post-title"><a href="/capistrano-puma-is-not-active-cannot-reload">Capistrano & Puma; service puma is not active, cannot reload</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>When trying to use the Capistrano Puma gem to restart Puma via systemd, we may run into an error along the lines of:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>puma_APP_NAME.service is not active, cannot reload
</code></pre></div>
<p>This typically happens either because the service was never enabled or because in the time which elapsed between it being enabled and the first deploy taking place, it has crashed a sufficient number of times that it is no longer active.</p>

<p>The behaviour we want in this scenario is to reload the service if it is active, otherwise to restart it.</p>

<p>Happily systemctl [supports this out of the box]<a href="https://www.freedesktop.org/software/systemd/man/systemctl.html">https://www.freedesktop.org/software/systemd/man/systemctl.html</a> with <code>systemctl reload-or-restart</code>.</p>

<p>We can add the following to <code>lib/capistrano/tasks</code> to add a task which uses this to the puma namespace provided by the capistrano puma gem:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="n">namespace</span> <span class="ss">:puma</span> <span class="k">do</span>
  <span class="n">namespace</span> <span class="ss">:systemd</span> <span class="k">do</span>
    <span class="n">desc</span> <span class="s1">&#39;Reload the puma service via systemd by sending USR1 (e.g. trigger a zero downtime deploy)&#39;</span>
    <span class="n">task</span> <span class="ss">:reload</span> <span class="k">do</span>
      <span class="n">on</span> <span class="n">roles</span><span class="p">(</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_role</span><span class="p">))</span> <span class="k">do</span>
        <span class="k">if</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_systemctl_user</span><span class="p">)</span> <span class="o">==</span> <span class="ss">:system</span>
          <span class="n">sudo</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_systemctl_bin</span><span class="p">)</span><span class="si">}</span><span class="s2"> reload-or-restart </span><span class="si">#{</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_service_unit_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span>
          <span class="n">execute</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_systemctl_bin</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;--user&quot;</span><span class="p">,</span> <span class="s2">&quot;reload&quot;</span><span class="p">,</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_service_unit_name</span><span class="p">)</span>
          <span class="n">execute</span> <span class="ss">:loginctl</span><span class="p">,</span> <span class="s2">&quot;enable-linger&quot;</span><span class="p">,</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_lingering_user</span><span class="p">)</span> <span class="k">if</span> <span class="n">fetch</span><span class="p">(</span><span class="ss">:puma_enable_lingering</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">after</span> <span class="s1">&#39;deploy:finished&#39;</span><span class="p">,</span> <span class="s1">&#39;puma:systemd:reload&#39;</span>
</code></pre></div>
<p>This should be used in conjunction with including the puma systemd tasks in our <code>Capfile</code> using the <code>load_hooks: false</code> option which prevents the default restart task from being called.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span></span><span class="n">install_plugin</span> <span class="no">Capistrano</span><span class="o">::</span><span class="no">Puma</span><span class="o">::</span><span class="no">Systemd</span><span class="p">,</span> <span class="ss">load_hooks</span><span class="p">:</span> <span class="kp">false</span>
</code></pre></div>
<p>The use of the above task also allows for zero downtime deploys when used with the relevant puma configuration and systemd unit file. See <a href="/capistrano-puma-neither-valid-executable-nor-absolute-path">this post</a> for more on the systemd unit file and <a href="https://github.com/TalkingQuickly/rdra_rails6_example">this repository</a> for a working example.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="14 Mar 2021">14 Mar 2021</time></span>
            <h2 class="post-title"><a href="/capistrano-puma-neither-valid-executable-nor-absolute-path">Capistrano & Puma; neither a valid executable name nor an absolute path</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>When attempting to deploy a Rails application using the puma web sever using the systemd functionality in the capistrano puma gem, we may receive the error message:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>Neither a valid executable name nor an absolute path
</code></pre></div>
<p>When attempting to start the systemd service. This most often occurs when using the capistrano rbenv plugin. This is because the Capistrano rbenv plugin modifies the <code>SSHKit.config.command_map[:bundle]</code> path to include the <code>RBENV_ROOT</code> and <code>RBENV_VERSION</code> environment variables at the start of the <code>bundle</code> path. Systemd doesn&#39;t support <code>Exec</code> command starting with environment variables, instead requiring them to be in separate <code>Environment</code> lines.</p>

<p>We can fix this by overriding the <code>puma.server.erb</code> template with a new systemd unit file as follows:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>[Unit]
Description=Puma HTTP Server for &lt;%= &quot;#{fetch(:application)} (#{fetch(:stage)})&quot; %&gt;
After=network.target

[Service]
Type=simple
&lt;%=&quot;User=#{puma_user(@role)}&quot; if fetch(:puma_systemctl_user) == :system %&gt;
WorkingDirectory=&lt;%= current_path %&gt;
ExecStart=/usr/local/rbenv/bin/rbenv exec bundle exec puma -C &lt;%= fetch(:puma_conf) %&gt;
ExecReload=/bin/kill -USR1 $MAINPID
ExecStop=/bin/kill -TSTP $MAINPID
StandardOutput=append:&lt;%= fetch(:puma_access_log) %&gt;
StandardError=append:&lt;%= fetch(:puma_error_log) %&gt;
&lt;%=&quot;EnvironmentFile=#{fetch(:puma_service_unit_env_file)}&quot; if fetch(:puma_service_unit_env_file) %&gt;
&lt;% fetch(:puma_service_unit_env_vars, []).each do |environment_variable| %&gt;
&lt;%=&quot;Environment=#{environment_variable}&quot; %&gt;
&lt;% end %&gt;

Environment=RBENV_VERSION=&lt;%= fetch(:rbenv_ruby) %&gt;
Environment=RBENV_ROOT=/usr/local/rbenv

Restart=always
RestartSec=1

SyslogIdentifier=puma_&lt;%= fetch(:application) %&gt;_&lt;%= fetch(:stage) %&gt;

[Install]
WantedBy=&lt;%=(fetch(:puma_systemctl_user) == :system) ? &quot;multi-user.target&quot; : &quot;default.target&quot;%&gt;
</code></pre></div>
<p>Note that this hardcodes the path to rbenv so if the path is different, for example because it&#39;s a user install not a system install, this will need updating.</p>

<p>This unit file also adds an <code>ExecReload</code> option to allow us to use systemd for zero downtime deploys.</p>

<p>For a fully working example see <a href="https://github.com/TalkingQuickly/rdra_rails6_example/">this repository</a>.</p>

<p>There&#39;s more information in <a href="https://github.com/seuros/capistrano-puma/issues/313">this github issue</a>.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="25 Feb 2021">25 Feb 2021</time></span>
            <h2 class="post-title"><a href="/kubernetes-sso-a-detailed-guide">Kubernetes Single Sign On - A detailed guide</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>In this series of posts we cover how to setup a comprehensive group based single sign on system for Kubernetes including the <code>kubectl</code> cli, any web application with ingress, a docker registry and gitea. We&#39;ll cover most of the common SSO models so adapting what&#39;s here to other applications such as Gitlab, Kibana, Grafana etc is simple.</p>

<p>The full solution uses Keycloak backed by OpenLDAP. OpenLDAP is required for the Gitea component, but can be skipped for the other components, including OIDC based SSO for <code>kubectl</code>.</p>

<p>Some of the highlights this series covers are:</p>

<ol>
<li>Login to the <code>kubectl</code> cli using SSO credentials via the browser</li>
<li>Replace basic auth ingress annotations with equally simple but much more secure SSO annotations</li>
<li>Push and pull to a secure private docker registry with full ACL</li>
</ol>

<ol>
  <li>
    <a href="/kubernetes-sso-a-comprehensive-guide">
  <strong>Contents and overview</strong>
</a>
  </li>
  <li>
    <a href="/installing-openldap-kubernetes-helm">
  Installing OpenLDAP
</a>
  </li>
  <li>
    <a href="/installing-keycloak-kubernetes-helm">
  Installing Keycloak
</a>
  </li>
  <li>
    <a href="/keycloak-and-openldap-on-kubernetes">
  Linking Keycloak and OpenLDAP
</a>
  </li>
  <li>
    <a href="/setting-up-oidc-login-kubernetes-kubectl-with-keycloak">
  OIDC Kubectl Login with Keycloak
</a>
  </li>
  <li>
    <a href="/webapp-authentication-keycloak-OAuth2-proxy-nginx-ingress-kubernetes">
  Authenticate any web app using ingress annotations
</a>
  </li>
  <li>
    <a href="/gitea-sso-with-keycloak-openldap-openid-connect">
  Gitea (requires LDAP)
</a>
  </li>
  <li>
    <a href="/docker-registry-authentication-with-keycloak">
  Simple Docker Registry
</a>
  </li>
  <li>
    <a href="/harbor-docker-registry-on-kubernetes-authentication-with-keycloak">
  Harbor Docker Registry with ACL
</a>
  </li>
</ol>

<p>Finally there were a lot of excellent resources I leant on when creating this series, there&#39;s a summary of the key ones <a href="/kubernetes-sso-links">here</a>.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="23 Feb 2021">23 Feb 2021</time></span>
            <h2 class="post-title"><a href="/setting-up-oidc-login-kubernetes-kubectl-with-keycloak">OIDC Login to Kubernetes and Kubectl with Keycloak</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>A commonly cited pain point for teams working with Kubernetes clusters is managing the configuration to connect to the cluster. All to often this ends up being either sending KUBECONFIG files with hardcoded credentials back and forth or fragile custom shell scripts wrapping the AWS or GCP cli&#39;s.</p>

<p>In this post we&#39;ll integrate Kubernetes with Keycloak so that when we execute a <code>kubectl</code> or <code>helm</code> command, if the user is not already authenticated, they&#39;ll be presented with a keycloak browser login where they can enter their credentials. No more sharing KUBECONFIG files and forgetting to export different KUBECONFIG paths!</p>

<p>We&#39;ll also configure group based access control, so we can, for example create a <code>KubernetesAdminstrators</code> group, and have all users in that group given <code>cluster-admin</code> access automatically.</p>

<p>When we remove a user from Keycloak (or remove them from the relevant groups within Keycloak) they will then lose access to the cluster (subject to token expiry).</p>

<p>For this we&#39;ll be using OpenID Connect, more <a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#openid-connect-tokens">here</a> on how this works.</p>

<p>By default, configuring Kubernetes to support OIDC auth requires passing flags to the kubelet API server. The challenge with this approach is that only one such provider can be configured and managed Kubernetes offerings - e.g. GCP or AWS - use this for their proprietary IAM systems.</p>

<p>To address this we will use <a href="https://github.com/jetstack/kube-oidc-proxy">kube-oidc-proxy</a>, a tool from Jetstack which allows us to connect to a proxy server which will manage OIDC authentication and use impersonation to give the authenticating user the required permissions. This approach has the benefit of being universal across clusters, so we don&#39;t have to follow different approaches for our managed vs unmanaged clusters.</p>

<p>This post is part of a series on single sign on for Kubernetes.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="21 Feb 2021">21 Feb 2021</time></span>
            <h2 class="post-title"><a href="/webapp-authentication-keycloak-OAuth2-proxy-nginx-ingress-kubernetes">Web application authentication and authorization with Keycloak and OAuth2 Proxy on Kubernetes using Nginx Ingress</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>In this post we&#39;ll setup a generic solution which allows us to add authentication via Keycloak to any application, simply by adding an ingress annotation. This gives us a much more extendable and secure alternative to basic auth.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="19 Feb 2021">19 Feb 2021</time></span>
            <h2 class="post-title"><a href="/harbor-docker-registry-on-kubernetes-authentication-with-keycloak">Comprehensive docker registry on Kubernetes with Harbor and Keycloak for single sign on</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>In this post we&#39;ll install a feature rich but lightweight docker registry and integrate login and authorization with Keycloak users and groups. </p>

<p><a href="https://goharbor.io">Harbor</a> is an open source registry which can serve multiple types of cloud artifacts and secure them using fine grained access control. In this case we&#39;ll be focussed on using harbor as a docker image registry and linking it&#39;s authentication with Keycloak but it is also capable of serving multiple other types of artifact, including helm charts.</p>

<p>This post is part of a series on single sign on for Kubernetes.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="18 Feb 2021">18 Feb 2021</time></span>
            <h2 class="post-title"><a href="/docker-registry-authentication-with-keycloak">Docker Registry Authentication on Kubernetes with Keycloak</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>In this post we&#39;ll cover how to use Keycloak to provide a simple authentication layer for a Docker registry. Simple meaning that in order to push and pull images to the registry, the user will first need to <code>docker login</code> as any valid user in the provided Keycloak realm. Note that there is no additional access control, so all Keycloak users have the ability to perform any action on any image once authenticated. For more fine grained controls, see the section on <a href="/harbor-docker-registry-on-kubernetes-authentication-with-keycloak">using Harbour</a>.</p>

<p>This post is part of a series on single sign on for Kubernetes.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="16 Feb 2021">16 Feb 2021</time></span>
            <h2 class="post-title"><a href="/gitea-sso-with-keycloak-openldap-openid-connect">Gitea SSO with Keycloak, OpenLDAP and OpenID Connect</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>Gitea is a lightweight open source git service. As an aside, Gitea - especially when combined with Drone CI - is one of my favourite pieces of open source software!</p>

<p>It&#39;s minimal footprint and easy to use interface make it perfect for running on clusters to facilitate git push deploys and CI.</p>

<p>Here we&#39;ll configure OpenLDAP for centralised user management and single sign on. We&#39;ll optionally configure OpenID Connect but with several caveats on its usage.</p>

<p>This post is part of a series on single sign on for Kubernetes.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="05 Feb 2021">05 Feb 2021</time></span>
            <h2 class="post-title"><a href="/keycloak-and-openldap-on-kubernetes">Keycloak and OpenLDAP on Kubernetes</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>In this post we&#39;ll cover how - having installed Keycloak and OpenLDAP separately on Kubernetes - to link the two together so that Keycloak uses OpenLDAP as it&#39;s primary store for user data.</p>

<p>This post is part of a series on single sign on for Kubernetes.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="01 Feb 2021">01 Feb 2021</time></span>
            <h2 class="post-title"><a href="/installing-openldap-kubernetes-helm">Installing OpenLDAP on Kubernetes with Helm</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>In this post we cover how to install OpenLDAP on Kubernetes and how to test that it is working using the command line.</p>

<p>LDAP while an older - and in some ways more challenging to work with - approach to SSO than something like OIDC, is still the de-facto standard.</p>

<p>There are many popular applications which don&#39;t support OIDC but do support LDAP. This is likely to be the case for many years to come so for now, any robust SSO solution is likely to need to support LDAP.</p>

<p>This post is part of a series on single sign on for Kubernetes</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="27 Jan 2021">27 Jan 2021</time></span>
            <h2 class="post-title"><a href="/installing-keycloak-kubernetes-helm">Installing Keycloak on Kubernetes</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>Keycloak is a widely used open source identity and access management system. Think Okta but open source. This is where users will actually enter their username and password for services and where we&#39;ll configure which users can login to which applications. It will also provide users with a single directory of applications they can login to.</p>

<p>In this post - as part of the larger series on Kubernetes SSO - we cover how to install Keycloak on Kubernetes.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="15 Jan 2021">15 Jan 2021</time></span>
            <h2 class="post-title"><a href="/kubernetes-sso-links">Useful Links when Setting up SSO on Kubernetes</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>While creating the comprehensive guide to Kubernetes SSO, I leant heavily on many great pieces of existing content, a lot of them are included here.</p>
</p>
        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="08 Jan 2021">08 Jan 2021</time></span>
            <h2 class="post-title"><a href="/2021/01/debian-dev-environment-for-remote-vscode/">Automated remote Debian development environment for VSCode with Ansible</a></h2>

        </header>
        <section class="post-excerpt">
            <p><p>One of the things VSCode has done extremely well is creating a seamless remote development experience. Using the remote extension pack, specifically the SSH development extension, it&#39;s possible to run VSCode locally, while performing all actions on a remote server completely seamlessly. This allows us to use a local VM for much faster docker development on macOS. It also means we are free to spin up powerful Cloud VM&#39;s with many cores and plenty of RAM when we&#39;re working on more intensive tasks.</p>

<p>With this setup I seamlessly switch between fully local development using a Virtualbox VM and a 16 core cloud VM with 64GB of RAM when I need more horsepower. In both environments this provides the level of Docker performance I associate with developing directly on Linux machines.</p>

<p>This is streamlined using an Ansible playbook which automatically sets up Debian VM&#39;s with sensible defaults for development, including a beautiful default ZSH configuration (inc auto-completions) and easy language version management with asdf. This post starts with the practical steps required for this setup, and then goes on to explain what&#39;s being installed and how it works.</p>
</p>
        </section>
    </article>

    

    <nav class="pagination" role="pagination">

        

        <span class="page-number"> Page 1 of 3 </span>

        
        <a class="older-posts" href="/page2/" title="Next Page">Older Posts &raquo;</a>
        
    </nav>


</main>


    <footer class="site-footer">
        <a class="subscribe icon-feed" href="/rss.xml"><span class="tooltip">Subscribe!</span></a>
        <div class="inner">
          <section class="copyright">All content copyright <a href="/about.html">Ben Dixon</a> &copy; &bull; All rights reserved. Twitter: <a href="http://www.twitter.com/talkingquickly" target="_blank">@talkingquickly</a></section>
             <section class="poweredby">Made with Jekyll and based on the <a href="http://github.com/rosario/kasper" target="_blank">Kasper theme</a></section>
        </div>
    </footer>


    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-7333902-35']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>
</html>
